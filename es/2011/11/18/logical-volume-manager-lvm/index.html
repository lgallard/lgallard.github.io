<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.6.0 by Michael Rose
  Copyright 2017 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE.txt
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin SEO -->









<title>Logical Volume Manager (LVM) - lgallardo.com</title>




<meta name="description" content="">




<meta name="author" content="Luis Gallardo">

<meta property="og:locale" content="en">
<meta property="og:site_name" content="lgallardo.com">
<meta property="og:title" content="Logical Volume Manager (LVM)">


  <link rel="canonical" href="http://lgallardo.com/es/2011/11/18/logical-volume-manager-lvm/">
  <meta property="og:url" content="http://lgallardo.com/es/2011/11/18/logical-volume-manager-lvm/">



  <meta property="og:description" content="">



  <meta name="twitter:site" content="@lgallard">
  <meta name="twitter:title" content="Logical Volume Manager (LVM)">
  <meta name="twitter:description" content="">
  <meta name="twitter:url" content="http://lgallardo.com/2011/11/18/logical-volume-manager-lvm/">

  
    <meta name="twitter:card" content="summary">
    
  

  
    <meta name="twitter:creator" content="@Luis Gallardo">
  



  

  





  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2011-11-18T06:30:45-03:00">








  <script type="application/ld+json">
    {
      "@context" : "http://schema.org",
      "@type" : "Person",
      "name" : "Luis M. Gallardo D.",
      "url" : "http://lgallardo.com/es",
      "sameAs" : null
    }
  </script>






<!-- end SEO -->


<link href="http://lgallardo.com/es/feed.xml" type="application/atom+xml" rel="alternate" title="lgallardo.com Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="http://lgallardo.com/es/assets/css/main.css">

<!--[if lte IE 9]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->




    <!-- start custom head snippets -->
<!-- 

  
  <a href="/2011/11/18/logical-volume-manager-lvm/" >English</a>

-->
<!-- insert favicons. use http://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--post">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->
    <div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        <a class="site-title" href="http://lgallardo.com/es/">lgallardo.com</a>
        <ul class="visible-links">
          
            
            <li class="masthead__menu-item"><a href="http://lgallardo.com/es/categories/">Categories</a></li>
          
            
            <li class="masthead__menu-item"><a href="http://lgallardo.com/es/tags/">Tags</a></li>
          
          
            
            <a href="/2011/11/18/logical-volume-manager-lvm/" >English</a>
          
        </ul>
        <button><div class="navicon"></div></button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>



    <div class="post">
  <h1 class="post-title">Logical Volume Manager (LVM)</h1>
  <span class="post-date">18 Nov 2011</span>
  <center><img src="/images/logical-volume-manager-lvm.jpg" alt="LVM" /></center>
<p><br /></p>

<p>En el esquema de particionamiento tradicional de discos el administrador del sistema planifica con antelación el uso que se le dará cada partición. Por ejemplo, para una laptop con disco duro de 120 GB y RAM de 1 GB se puede tener el siguiente esquema de particiones:</p>

<ul>
  <li>1 GB para swap (/dev/sda1),</li>
  <li>12 GB para la raíz (/dev/sda2),</li>
  <li>107 GB para /home (/dev/sda3), es decir,  el resto del disco.</li>
</ul>

<table>
  <tbody>
    <tr>
      <td>Hasta aquí todo bien, pero qué pasa si el día de mañana el tamaño de la RAM aumenta a 2 GB? Para invernar habrá que aumentar la swap, y como ya se particionó todo el disco y no se dejó espacio lo que queda es reparticionar el disco, bien sea redimensionando con utilidades que lo permitan, siempre y cuando el sistema de archivo también lo permita (por ejemplo, los sistemas ext[2</td>
      <td>3</td>
      <td>4] permite redimensionamiento).</td>
    </tr>
  </tbody>
</table>

<p>¿No existe algo más flexible? Si, se llama LVM (Logical Volume Manager) , y en esencia permite redimensionar en caliente las particiones, para por ejemplo, quitar 1GB de /home (/dev/sda3) y dárselo a la swap (/dev/sda1).</p>

<h2 id="lvm-logical-volume-manager">LVM (Logical Volume Manager)</h2>

<p>Para poder usar LVM primero se debe asignar volúmenes físicos, luego asignar volúmenes de grupo y por último volúmenes lógicos. Todo esto parece confuso a la primera, pero vamos a explicar cada uno de estos términos y cómo se relacionan:</p>

<ul>
  <li><strong>Volúmenes físicos:</strong> Es el soporte final donde se guardaran los datos, y pueden ser varios discos o incluso particiones de un disco. No guarda relación directa con los puntos de montajes. <strong>Ejemplos de volúmenes físicos:</strong> /dev/sda , /dev/sdb1, etc.</li>
  <li><strong>Volúmenes de grupo:</strong> Es la agrupación de los volúmenes físicos en un volumen que permite ver todos los discos y particiones como uno solo dispositivo. <strong>Ejemplo de volumen de grupo:</strong> /dev/vg00</li>
  <li><strong>Volúmenes lógicos:</strong> Son los volúmenes donde irán nuestros sistemas de archivos (ext2, ext3,xfs,vfat, por ejemplo) y por ende los puntos de montaje (/, /home, swap, /usr, /var, etc). En este nivel es donde se hace el formateo del sistema de archivos a usar, y es donde los datos se distribuirán a nivel lógico, similar a las particiones que acostumbramos a usar. <strong>Ejemplo de volúmenes lógicos:</strong> /dev/vg00/lv_rootfs, /dev/vg00/lv_swap, /dev/vg00/lv_home.</li>
</ul>

<h2 id="instalación-de-lvm">Instalación de LVM</h2>

<p>En Debian puede usarse LVM instalando el siguiente paquete:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>aptitude install lvm2
</code></pre></div></div>

<p>En otras distribuciones como Fedora, Red Hat o el mismo Ubuntu deben buscar el nombre adecuado del paquete para su instalación.</p>

<h2 id="Órdenes-de-lvm">Órdenes de LVM</h2>

<p>Para crear un LVM con sus volúmenes físicos, de grupo y lógicos veamos algunas de las instrucciones que tenemos disponible:</p>

<h3 id="volúmenes-físicos">Volúmenes físicos</h3>

<table border="0">
<tr>
<td>
Orden
</td>

<td>
Descripción
</td>
</tr>

<tr>
<td>
pvcreate
</td>

<td>
Crea volúmenes físicos para ser usado por LVM
</td>
</tr>

<tr>
<td>
pvs
</td>

<td>
Muestra información acerca los volúmenes lógicos
</td>
</tr>

<tr>
<td>
pvdisplay
</td>

<td>
Muestra varios atributos de los volúmenes físicos
</td>
</tr>

<tr>
<td>
pvresize
</td>

<td>
Redimensiona volúmenes físicos
</td>
</tr>

<tr>
<td>
pvmove
</td>

<td>
Mueve datos de un volumen físico a otro.
</td>
</tr>
</table>

<h3 id="volúmenes-de-grupo">Volúmenes de grupo</h3>

<table border="0">
<tr>
<td>
Orden
</td>

<td>
Descripción
</td>
</tr>

<tr>
<td>
vgcreate
</td>

<td>
Crea volúmnes de grupo para ser usado por LVM
</td>
</tr>

<tr>
<td>
vgs
</td>

<td>
Muestra información acerca de los volúmenes de grupo
</td>
</tr>

<tr>
<td>
vgdisplay
</td>

<td>
Muestra varios atributos de los volúmenes de grupo
</td>
</tr>

<tr>
<td>
vgextend
</td>

<td>
Agrega volúmenes físicos a un volumen de grupo
</td>
</tr>

<tr>
<td>
vfreduce
</td>

<td>
Quita volúmenes físicos del volumen de grupo
</td>
</tr>

<tr>
<td>
vgremove
</td>

<td>
Elimina volúmenes de grupo
</td>
</tr>
</table>

<h3 id="volúmenes-lógicos">Volúmenes lógicos</h3>

<table border="0">
<tr>
<td>
Orden
</td>

<td>
Descripción
</td>
</tr>

<tr>
<td>
lvcreate
</td>

<td>
 Crea volúmnes lógicos para ser usado por LVM
</td>
</tr>

<tr>
<td>
lvs
</td>

<td>
Muestra información acerca de los volúmenes lógicos
</td>
</tr>

<tr>
<td>
lvdisplay
</td>

<td>
Muestra varios atributos de los volúmenes lógicos
</td>
</tr>

<tr>
<td>
lvresize | lvreduce | lvextend
</td>

<td>
Redimensiona volúmenes lógicos
</td>
</tr>

<tr>
<td>
lvmove
</td>

<td>
Elimina volúmenes lógicos del sistema
</td>
</tr>
</table>

<h2 id="ejemplo-de-creación-de-un-lvm">Ejemplo de creación de un LVM</h2>

<p>Supongamos que se tiene el disco /dev/sdb  libre con 8 GB,  con dos particiones de 4GB cada una (/dev/sdb1 y /dev/sdb2), y sobre estas particiones se quiere crear un LVM que alojará los puntos de montajes: La raíz (/) de 1 GB, la swap de 1 GB (swap) y el resto de los 6 GB al directorio de los usuarios (/home). Para hacer el LVM podemos escribir las siguientes órdenes:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@buckbeak:~# pvcreate /dev/sdb1

root@buckbeak:~#pvcreate /dev/sdb2
Physical volume <span class="s2">"/dev/sdb2"</span> successfully created

root@buckbeak:~# pvs

PV         VG         Fmt  Attr PSize  PFree
/dev/sdb1                         lvm2 a-    4.00g 4.00g
/dev/sdb2                         lvm2 a-    3.99g 3.99g

root@buckbeak:~# vgcreate vg_group01 /dev/sdb1 /dev/sdb2

Volume group <span class="s2">"vg_group01"</span> successfully created

root@buckbeak:~# vgs

VG         <span class="c">#PV #LV #SN Attr   VSize  VFree</span>
vg_group01   2   0   0 wz--n-  7.99g 7.99g

root@buckbeak:~# lvcreate <span class="nt">-n</span> lv_rootfs vg_group01 <span class="nt">-L</span> 1G
Logical volume <span class="s2">"lv_rootfs"</span> created

root@buckbeak:~# lvcreate <span class="nt">-n</span> lv_swap vg_group01 <span class="nt">-L</span> 1G
Logical volume <span class="s2">"lv_swap"</span> created

root@buckbeak:~# lvcreate <span class="nt">-n</span> lv_home vg_group01 <span class="nt">-L</span> 6G
Volume group <span class="s2">"vg_group01"</span> has insufficient free space <span class="o">(</span>1534 extents<span class="o">)</span>: 1536 required

root@buckbeak:~# lvcreate <span class="nt">-n</span> lv_home vg_group01 <span class="nt">-l</span> 1534
Logical volume <span class="s2">"lv_home"</span> created

root@buckbeak:~# lvs
LV        VG         Attr   LSize  Origin Snap%  Move Log Copy%  Convert
lv_home   vg_group01 <span class="nt">-wi-a-</span>  5.99g
lv_rootfs vg_group01 <span class="nt">-wi-a-</span>  1.00g
lv_swap   vg_group01 <span class="nt">-wi-a-</span>  1.00g
</code></pre></div></div>

<p>Ahora se puede dar el sistema de archivo para cada uno de los volúmenes lógicos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>root@buckbeak:~# mkfs

Filesystem <span class="nv">label</span><span class="o">=</span>
OS <span class="nb">type</span>: Linux
Block <span class="nv">size</span><span class="o">=</span>4096 <span class="o">(</span><span class="nv">log</span><span class="o">=</span>2<span class="o">)</span>
Fragment <span class="nv">size</span><span class="o">=</span>4096 <span class="o">(</span><span class="nv">log</span><span class="o">=</span>2<span class="o">)</span>
<span class="nv">Stride</span><span class="o">=</span>0 blocks, Stripe <span class="nv">width</span><span class="o">=</span>0 blocks
65536 inodes, 262144 blocks
13107 blocks <span class="o">(</span>5.00%<span class="o">)</span> reserved <span class="k">for </span>the super user
First data <span class="nv">block</span><span class="o">=</span>0
Maximum filesystem <span class="nv">blocks</span><span class="o">=</span>268435456
8 block groups
32768 blocks per group, 32768 fragments per group
8192 inodes per group
Superblock backups stored on blocks:
32768, 98304, 163840, 229376

Writing inode tables: <span class="k">done
</span>Creating journal <span class="o">(</span>8192 blocks<span class="o">)</span>: <span class="k">done
</span>Writing superblocks and filesystem accounting information: <span class="k">done

</span>This filesystem will be automatically checked every 34 mounts or
180 days, whichever comes first.  Use tune2fs <span class="nt">-c</span> or <span class="nt">-i</span> to override.

root@buckbeak:~# mkfs.ext4 /dev/vg_group01/lv_home
mke2fs 1.41.12 <span class="o">(</span>17-May-2010<span class="o">)</span>
Filesystem <span class="nv">label</span><span class="o">=</span>
OS <span class="nb">type</span>: Linux
Block <span class="nv">size</span><span class="o">=</span>4096 <span class="o">(</span><span class="nv">log</span><span class="o">=</span>2<span class="o">)</span>
Fragment <span class="nv">size</span><span class="o">=</span>4096 <span class="o">(</span><span class="nv">log</span><span class="o">=</span>2<span class="o">)</span>
<span class="nv">Stride</span><span class="o">=</span>0 blocks, Stripe <span class="nv">width</span><span class="o">=</span>0 blocks
393216 inodes, 1570816 blocks
78540 blocks <span class="o">(</span>5.00%<span class="o">)</span> reserved <span class="k">for </span>the super user
First data <span class="nv">block</span><span class="o">=</span>0
Maximum filesystem <span class="nv">blocks</span><span class="o">=</span>1610612736
48 block groups
32768 blocks per group, 32768 fragments per group
8192 inodes per group
Superblock backups stored on blocks:
32768, 98304, 163840, 229376, 294912, 819200, 884736

Writing inode tables: <span class="k">done
</span>Creating journal <span class="o">(</span>32768 blocks<span class="o">)</span>: <span class="k">done
</span>Writing superblocks and filesystem accounting information: <span class="k">done

</span>This filesystem will be automatically checked every 20 mounts or
180 days, whichever comes first.  Use tune2fs <span class="nt">-c</span> or <span class="nt">-i</span> to override.

root@buckbeak:~# mkswap /dev/vg_group01/lv_swap
mkswap: /dev/vg_group01/lv_swap: warning: don<span class="s1">'t erase bootbits sectors
on whole disk. Use -f to force.
Setting up swapspace version 1, size = 1048572 KiB
no label, UUID=e743b4f3-1c80-4503-be88-6934d575cd55

root@buckbeak:~# swapon /dev/vg_group01/lv_swap

root@buckbeak:~# swapon -s
Filename                Type        Size    Used    Priority
/dev/dm-1                               partition    2064376    8    -1
/dev/dm-5                               partition    1048568    0    -2
</span></code></pre></div></div>

<p>Si se quieren usar estos volúmenes lógicos, bien puenden montarse con la orden mount o especificarlos en el archivo /etc/fstab para que sea montados al iniciar el sistema.</p>

<h2 id="referencias">Referencias</h2>

<ul>
  <li><a href="http://en.wikipedia.org/wiki/Logical_Volume_Manager_%28Linux%29" target="_blank">LVM en Wikipedia</a></li>
  <li><a href="http://sourceware.org/lvm2/" rel="nofollow" target="_blank">LVM2 Resource Page</a></li>
  <li><a href="http://www.markus-gattol.name/ws/lvm.html" rel="nofollow" target="_blank">All about LVM on one page</a></li>
</ul>

</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/es/2017/10/13/posting-from-jekyll-to-github-pages-with-bitbucket-pipeline/">
            Publicando de Jekyll a Github Pages con Bitbucket Pipeline
            <small>13 Oct 2017</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/es/2017/02/11/usando-aws-lambda-para-copiar-snapshots-de-rds-entre-regiones/">
            Usando AWS Lambda para copiar snapshots de RDS entre regiones
            <small>10 Feb 2017</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/es/2016/09/13/como-cargar-el-driver-de-virtualbox/">
            Cómo cargar el driver de VirtualBox
            <small>13 Sep 2016</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>


    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    
    
      <li><a href="https://twitter.com/lgallard"><i class="fa fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li>
    
    
    
      <li><a href="http://github.com/lgallard"><i class="fa fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
    
    
    
    <li><a href="http://lgallardo.com/es/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2017 Luis M. Gallardo D.. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="http://lgallardo.com/es/assets/js/main.min.js"></script>




  
      
  <script>
    var disqus_config = function () {
      this.page.url = "http://lgallardo.com/es/2011/11/18/logical-volume-manager-lvm/";  // Replace PAGE_URL with your page's canonical URL variable
      this.page.identifier = "/2011/11/18/logical-volume-manager-lvm"; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    (function() { // DON'T EDIT BELOW THIS LINE
      var d = document, s = d.createElement('script');
      s.src = 'https://lgallard.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


    



  </body>
</html>